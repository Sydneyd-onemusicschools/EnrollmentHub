<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Director's Portal</title>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700;800&display=swap" rel="stylesheet">
  <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>
  <style>
    * { margin: 0; padding: 0; box-sizing: border-box; }

    :root {
      --color-bg: #F5F5F7;
      --color-white: #FFFFFF;
      --color-coral: #F97B5F;
      --color-coral-light: #FFA07A;
      --color-pink: #F472B6;
      --gradient-primary: linear-gradient(135deg, #F97B5F 0%, #F472B6 100%);
      --color-text: #1F2937;
      --color-text-muted: #6B7280;
      --color-text-light: #9CA3AF;
      --color-border: #E5E7EB;
      --color-success: #10B981;
      --color-warning: #F59E0B;
      --color-blue: #3B82F6;
      --shadow-sm: 0 1px 3px rgba(0, 0, 0, 0.05);
      --shadow-md: 0 4px 12px rgba(0, 0, 0, 0.08);
      --shadow-lg: 0 8px 24px rgba(0, 0, 0, 0.12);
      --radius-sm: 8px;
      --radius-md: 12px;
      --radius-lg: 16px;
      --sidebar-width: 260px;
    }

    body {
      font-family: 'Inter', -apple-system, BlinkMacSystemFont, sans-serif;
      background: var(--color-bg);
      color: var(--color-text);
      min-height: 100vh;
      line-height: 1.6;
    }

    .app-layout { display: flex; min-height: 100vh; }

    /* Sidebar */
    .sidebar {
      width: var(--sidebar-width);
      background: var(--color-white);
      border-right: 1px solid var(--color-border);
      position: fixed;
      top: 0;
      left: 0;
      height: 100vh;
      display: flex;
      flex-direction: column;
      z-index: 100;
      transition: transform 0.3s ease;
    }

    .sidebar-header {
      padding: 20px;
      border-bottom: 1px solid var(--color-border);
    }

    .sidebar-logo {
      display: flex;
      align-items: center;
      gap: 12px;
    }

    .sidebar-logo-icon {
      width: 42px;
      height: 42px;
      background: var(--gradient-primary);
      border-radius: var(--radius-md);
      display: flex;
      align-items: center;
      justify-content: center;
      color: white;
      flex-shrink: 0;
    }

    .sidebar-logo-text h1 { font-size: 15px; font-weight: 700; color: var(--color-text); }
    .sidebar-logo-text p { font-size: 11px; color: var(--color-text-muted); margin-top: 2px; }

    .sidebar-nav { flex: 1; padding: 16px 12px; overflow-y: auto; }

    .nav-section { margin-bottom: 20px; }
    .nav-section-title {
      font-size: 10px;
      font-weight: 700;
      text-transform: uppercase;
      letter-spacing: 0.8px;
      color: var(--color-text-light);
      padding: 0 12px;
      margin-bottom: 8px;
    }

    .nav-item {
      display: flex;
      align-items: center;
      gap: 10px;
      padding: 10px 12px;
      border-radius: var(--radius-sm);
      color: var(--color-text-muted);
      text-decoration: none;
      font-size: 14px;
      font-weight: 500;
      cursor: pointer;
      transition: all 0.15s ease;
      margin-bottom: 2px;
    }

    .nav-item:hover { background: var(--color-bg); color: var(--color-text); }
    .nav-item.active {
      background: linear-gradient(135deg, rgba(249, 123, 95, 0.12) 0%, rgba(244, 114, 182, 0.12) 100%);
      color: var(--color-coral);
    }
    .nav-item.active svg { color: var(--color-coral); }
    .nav-item svg { width: 18px; height: 18px; flex-shrink: 0; }

    .sidebar-footer { padding: 16px 20px; border-top: 1px solid var(--color-border); }
    .sidebar-footer p { font-size: 11px; color: var(--color-text-light); }

    /* Mobile Header */
    .mobile-header {
      display: none;
      position: fixed;
      top: 0;
      left: 0;
      right: 0;
      height: 56px;
      background: var(--color-white);
      border-bottom: 1px solid var(--color-border);
      padding: 0 16px;
      align-items: center;
      justify-content: space-between;
      z-index: 99;
    }

    .mobile-menu-btn {
      width: 40px;
      height: 40px;
      border: none;
      background: transparent;
      cursor: pointer;
      display: flex;
      align-items: center;
      justify-content: center;
      color: var(--color-text);
      border-radius: var(--radius-sm);
    }

    .mobile-menu-btn:hover { background: var(--color-bg); }

    .sidebar-overlay {
      display: none;
      position: fixed;
      inset: 0;
      background: rgba(0, 0, 0, 0.5);
      z-index: 99;
    }

    /* Main Content */
    .main-content {
      flex: 1;
      margin-left: var(--sidebar-width);
      padding: 32px;
      min-height: 100vh;
    }

    .page-header { margin-bottom: 28px; }
    .page-header h1 { font-size: 26px; font-weight: 700; margin-bottom: 6px; color: var(--color-text); }
    .page-header p { font-size: 14px; color: var(--color-text-muted); }

    .section { display: none; }
    .section.active { display: block; animation: fadeIn 0.25s ease; }

    @keyframes fadeIn {
      from { opacity: 0; transform: translateY(8px); }
      to { opacity: 1; transform: translateY(0); }
    }

    /* Cards */
    .card {
      background: var(--color-white);
      border-radius: var(--radius-lg);
      padding: 24px;
      margin-bottom: 24px;
      box-shadow: var(--shadow-sm);
      border: 1px solid var(--color-border);
    }

    .card-header {
      display: flex;
      align-items: center;
      gap: 14px;
      margin-bottom: 20px;
    }

    .card-icon {
      width: 42px;
      height: 42px;
      background: linear-gradient(135deg, rgba(249, 123, 95, 0.1) 0%, rgba(244, 114, 182, 0.1) 100%);
      border-radius: var(--radius-md);
      display: flex;
      align-items: center;
      justify-content: center;
      color: var(--color-coral);
      flex-shrink: 0;
    }

    .card-title { font-size: 17px; font-weight: 600; color: var(--color-text); }
    .card-subtitle { font-size: 13px; color: var(--color-text-muted); margin-top: 2px; }

    /* Hero Banner */
    .hero-banner {
      background: var(--gradient-primary);
      border-radius: var(--radius-lg);
      padding: 28px 32px;
      color: white;
      margin-bottom: 24px;
      position: relative;
      overflow: hidden;
    }

    .hero-banner::before {
      content: '';
      position: absolute;
      top: -60%;
      right: -15%;
      width: 280px;
      height: 280px;
      background: rgba(255, 255, 255, 0.1);
      border-radius: 50%;
    }

    .hero-banner h2 { font-size: 22px; font-weight: 700; margin-bottom: 6px; position: relative; }
    .hero-banner p { font-size: 14px; opacity: 0.92; position: relative; max-width: 550px; }
    .hero-banner .promo-badge {
      display: inline-flex;
      align-items: center;
      gap: 6px;
      background: rgba(255, 255, 255, 0.2);
      padding: 6px 14px;
      border-radius: 20px;
      font-size: 13px;
      font-weight: 600;
      margin-top: 14px;
    }

    /* Stats */
    .stats-grid {
      display: grid;
      grid-template-columns: repeat(4, 1fr);
      gap: 16px;
      margin-bottom: 24px;
    }

    .stat-card {
      background: var(--color-white);
      border-radius: var(--radius-md);
      padding: 18px 20px;
      box-shadow: var(--shadow-sm);
      border: 1px solid var(--color-border);
    }

    .stat-card-label { font-size: 12px; color: var(--color-text-muted); margin-bottom: 6px; font-weight: 500; }
    .stat-card-value { font-size: 28px; font-weight: 700; color: var(--color-text); }

    /* Announcements */
    .announcement-list { display: flex; flex-direction: column; gap: 12px; }
    .announcement-item {
      display: flex;
      gap: 16px;
      padding: 16px;
      background: var(--color-bg);
      border-radius: var(--radius-md);
      align-items: flex-start;
    }

    .announcement-date {
      text-align: center;
      min-width: 48px;
      padding: 8px;
      background: var(--color-white);
      border-radius: var(--radius-sm);
    }
    .announcement-date .day { font-size: 20px; font-weight: 700; color: var(--color-coral); line-height: 1; }
    .announcement-date .month { font-size: 11px; color: var(--color-text-muted); text-transform: uppercase; font-weight: 500; margin-top: 2px; }

    .announcement-content { flex: 1; }
    .announcement-content h4 { font-size: 14px; font-weight: 600; margin-bottom: 4px; color: var(--color-text); }
    .announcement-content p { font-size: 13px; color: var(--color-text-muted); line-height: 1.5; }

    /* Tabs */
    .tabs {
      display: flex;
      gap: 4px;
      background: var(--color-bg);
      padding: 4px;
      border-radius: var(--radius-md);
      margin-bottom: 20px;
    }

    .tab-btn {
      padding: 10px 20px;
      border: none;
      background: transparent;
      font-size: 13px;
      font-weight: 500;
      color: var(--color-text-muted);
      cursor: pointer;
      border-radius: var(--radius-sm);
      transition: all 0.15s ease;
      font-family: inherit;
    }

    .tab-btn:hover { color: var(--color-text); }
    .tab-btn.active {
      background: var(--color-white);
      color: var(--color-coral);
      box-shadow: var(--shadow-sm);
    }

    /* Promo Cards */
    .promo-grid {
      display: grid;
      grid-template-columns: repeat(auto-fill, minmax(320px, 1fr));
      gap: 16px;
    }

    .promo-card {
      background: var(--color-white);
      border: 1px solid var(--color-border);
      border-radius: var(--radius-md);
      padding: 20px;
      transition: all 0.2s ease;
    }

    .promo-card:hover {
      border-color: var(--color-coral);
      box-shadow: var(--shadow-md);
    }

    .promo-card-header {
      display: flex;
      justify-content: space-between;
      align-items: flex-start;
      margin-bottom: 12px;
    }

    .promo-status {
      padding: 4px 10px;
      border-radius: 12px;
      font-size: 11px;
      font-weight: 600;
      text-transform: uppercase;
    }

    .promo-status.active { background: rgba(16, 185, 129, 0.1); color: var(--color-success); }
    .promo-status.upcoming { background: rgba(59, 130, 246, 0.1); color: var(--color-blue); }
    .promo-status.ended { background: rgba(107, 114, 128, 0.1); color: var(--color-text-muted); }

    .promo-card h4 { font-size: 16px; font-weight: 600; margin-bottom: 6px; color: var(--color-text); }
    .promo-card .promo-dates { font-size: 12px; color: var(--color-text-muted); margin-bottom: 8px; }
    .promo-card .promo-discount {
      display: inline-block;
      background: var(--gradient-primary);
      color: white;
      padding: 4px 12px;
      border-radius: 12px;
      font-size: 12px;
      font-weight: 600;
      margin-bottom: 12px;
    }

    .promo-card p { font-size: 13px; color: var(--color-text-muted); line-height: 1.5; margin-bottom: 14px; }

    .promo-details-btn {
      display: inline-flex;
      align-items: center;
      gap: 6px;
      padding: 8px 14px;
      background: var(--color-bg);
      border: 1px solid var(--color-border);
      border-radius: var(--radius-sm);
      font-size: 13px;
      font-weight: 500;
      color: var(--color-text);
      cursor: pointer;
      transition: all 0.15s ease;
      font-family: inherit;
    }

    .promo-details-btn:hover {
      background: linear-gradient(135deg, rgba(249, 123, 95, 0.1) 0%, rgba(244, 114, 182, 0.1) 100%);
      border-color: var(--color-coral);
      color: var(--color-coral);
    }

    /* Discount Cards */
    .discount-grid {
      display: grid;
      grid-template-columns: repeat(auto-fill, minmax(320px, 1fr));
      gap: 20px;
    }

    .discount-card {
      background: var(--color-white);
      border: 1px solid var(--color-border);
      border-radius: var(--radius-lg);
      padding: 24px;
      transition: all 0.15s ease;
    }

    .discount-card:hover {
      border-color: var(--color-coral);
      box-shadow: var(--shadow-md);
    }

    .discount-card-header { margin-bottom: 12px; }

    .discount-status {
      display: inline-block;
      padding: 4px 12px;
      border-radius: 20px;
      font-size: 11px;
      font-weight: 600;
      text-transform: uppercase;
    }
    .discount-status.active { background: rgba(16, 185, 129, 0.1); color: var(--color-success); }
    .discount-status.upcoming { background: rgba(59, 130, 246, 0.1); color: var(--color-blue); }
    .discount-status.expired { background: var(--color-bg); color: var(--color-text-muted); }

    .discount-card h4 { font-size: 17px; font-weight: 600; margin-bottom: 8px; color: var(--color-text); }
    .discount-dates { font-size: 13px; color: var(--color-text-muted); margin-bottom: 12px; }
    .discount-amount {
      display: inline-block;
      background: var(--gradient-primary);
      color: white;
      padding: 6px 14px;
      border-radius: 20px;
      font-size: 13px;
      font-weight: 600;
      margin-bottom: 12px;
    }
    .discount-card > p { font-size: 14px; color: var(--color-text-muted); line-height: 1.6; }

    /* Contact Cards */
    .contact-grid {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
      gap: 16px;
    }

    .contact-card {
      background: var(--color-bg);
      border-radius: var(--radius-md);
      padding: 20px;
      display: flex;
      align-items: flex-start;
      gap: 16px;
    }

    .contact-card-icon {
      width: 48px;
      height: 48px;
      background: var(--color-white);
      border-radius: var(--radius-md);
      display: flex;
      align-items: center;
      justify-content: center;
      color: var(--color-coral);
      flex-shrink: 0;
    }

    .contact-card-content { flex: 1; }
    .contact-card h4 { font-size: 15px; font-weight: 600; margin-bottom: 4px; color: var(--color-text); }
    .contact-card p { font-size: 13px; color: var(--color-text-muted); margin-bottom: 10px; line-height: 1.5; }
    .contact-card a {
      display: inline-flex;
      align-items: center;
      gap: 4px;
      color: var(--color-coral);
      text-decoration: none;
      font-weight: 500;
      font-size: 14px;
    }
    .contact-card a:hover { text-decoration: underline; }

    /* Responsibility Lists */
    .responsibility-section { margin-bottom: 28px; }
    .responsibility-section:last-child { margin-bottom: 0; }

    .responsibility-header {
      display: flex;
      align-items: center;
      gap: 10px;
      margin-bottom: 14px;
    }

    .responsibility-badge {
      padding: 6px 14px;
      border-radius: 20px;
      font-size: 13px;
      font-weight: 600;
      display: inline-flex;
      align-items: center;
      gap: 6px;
    }
    .responsibility-badge.we-handle { background: rgba(16, 185, 129, 0.1); color: var(--color-success); }
    .responsibility-badge.you-handle { background: rgba(249, 123, 95, 0.1); color: var(--color-coral); }

    .responsibility-list {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
      gap: 10px;
    }

    .responsibility-item {
      display: flex;
      align-items: flex-start;
      gap: 12px;
      padding: 14px 16px;
      background: var(--color-bg);
      border-radius: var(--radius-md);
    }

    .responsibility-item .icon-wrapper {
      width: 24px;
      height: 24px;
      border-radius: 50%;
      display: flex;
      align-items: center;
      justify-content: center;
      flex-shrink: 0;
      margin-top: 1px;
    }

    .responsibility-item.we-handle .icon-wrapper { background: rgba(16, 185, 129, 0.15); color: var(--color-success); }
    .responsibility-item.you-handle .icon-wrapper { background: rgba(249, 123, 95, 0.15); color: var(--color-coral); }
    .responsibility-item .icon-wrapper svg { width: 14px; height: 14px; }
    .responsibility-item span { font-size: 14px; color: var(--color-text); line-height: 1.5; }

    /* Best Practices */
    .practices-grid {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(340px, 1fr));
      gap: 20px;
    }

    .practice-card {
      background: var(--color-white);
      border: 1px solid var(--color-border);
      border-radius: var(--radius-lg);
      padding: 24px;
      border-left: 4px solid var(--color-coral);
    }

    .practice-card h4 {
      font-size: 15px;
      font-weight: 600;
      margin-bottom: 10px;
      display: flex;
      align-items: center;
      gap: 12px;
      color: var(--color-text);
    }

    .practice-card h4 .number {
      width: 28px;
      height: 28px;
      background: var(--gradient-primary);
      color: white;
      border-radius: 50%;
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 13px;
      font-weight: 700;
      flex-shrink: 0;
    }

    .practice-card p { font-size: 13px; color: var(--color-text-muted); line-height: 1.6; }
    .practice-card ul { margin-top: 12px; padding-left: 18px; }
    .practice-card li { font-size: 13px; color: var(--color-text-muted); margin-bottom: 6px; }

    /* Policies */
    .policy-category { margin-bottom: 28px; }
    .policy-category:last-child { margin-bottom: 0; }

    .policy-category-title {
      font-size: 14px;
      font-weight: 600;
      margin-bottom: 12px;
      display: flex;
      align-items: center;
      gap: 8px;
      color: var(--color-text);
    }
    .policy-category-title svg { color: var(--color-coral); width: 18px; height: 18px; }

    .policy-list { display: flex; flex-direction: column; gap: 8px; }

    .policy-item {
      display: flex;
      align-items: center;
      justify-content: space-between;
      padding: 14px 18px;
      background: var(--color-bg);
      border-radius: var(--radius-md);
      text-decoration: none;
      color: var(--color-text);
      transition: all 0.15s ease;
    }

    .policy-item:hover {
      background: linear-gradient(135deg, rgba(249, 123, 95, 0.08) 0%, rgba(244, 114, 182, 0.08) 100%);
      transform: translateX(4px);
    }

    .policy-item-info { display: flex; align-items: center; gap: 12px; }
    .policy-item-icon {
      width: 36px;
      height: 36px;
      background: var(--color-white);
      border-radius: var(--radius-sm);
      display: flex;
      align-items: center;
      justify-content: center;
      color: var(--color-coral);
    }

    .policy-item h4 { font-size: 14px; font-weight: 500; }
    .policy-item svg.arrow { color: var(--color-text-light); width: 18px; height: 18px; }

    /* Script */
    .script-container {
      background: var(--color-white);
      border-radius: var(--radius-lg);
      padding: 32px;
      box-shadow: var(--shadow-sm);
      border: 1px solid var(--color-border);
    }

    .script-content { font-size: 15px; line-height: 1.8; color: var(--color-text); }
    .script-content h2 { font-size: 20px; font-weight: 600; margin: 28px 0 12px 0; color: var(--color-coral); }
    .script-content h2:first-child { margin-top: 0; }
    .script-content h3 { font-size: 16px; font-weight: 600; margin: 24px 0 10px 0; color: var(--color-text); }
    .script-content p { margin-bottom: 14px; }
    .script-content ul, .script-content ol { margin: 14px 0; padding-left: 24px; }
    .script-content li { margin-bottom: 8px; }
    .script-content blockquote {
      background: linear-gradient(135deg, rgba(249, 123, 95, 0.08) 0%, rgba(244, 114, 182, 0.08) 100%);
      border-left: 4px solid var(--color-coral);
      padding: 16px 20px;
      margin: 18px 0;
      border-radius: 0 var(--radius-md) var(--radius-md) 0;
      font-style: italic;
      color: var(--color-text-muted);
    }

    /* Links */
    .links-grid {
      display: grid;
      grid-template-columns: repeat(auto-fill, minmax(280px, 1fr));
      gap: 14px;
    }

    .link-card {
      display: flex;
      align-items: center;
      gap: 14px;
      padding: 16px;
      background: var(--color-bg);
      border-radius: var(--radius-md);
      text-decoration: none;
      color: var(--color-text);
      transition: all 0.15s ease;
    }

    .link-card:hover {
      background: linear-gradient(135deg, rgba(249, 123, 95, 0.1) 0%, rgba(244, 114, 182, 0.1) 100%);
      transform: translateY(-2px);
      box-shadow: var(--shadow-md);
    }

    .link-card-icon {
      width: 44px;
      height: 44px;
      background: var(--color-white);
      border-radius: var(--radius-md);
      display: flex;
      align-items: center;
      justify-content: center;
      color: var(--color-coral);
      flex-shrink: 0;
    }

    .link-card h4 { font-size: 14px; font-weight: 600; margin-bottom: 2px; }
    .link-card p { font-size: 12px; color: var(--color-text-muted); }

    /* Team */
    .team-grid {
      display: grid;
      grid-template-columns: repeat(auto-fill, minmax(300px, 1fr));
      gap: 20px;
    }

    .team-card {
      background: var(--color-white);
      border: 1px solid var(--color-border);
      border-radius: var(--radius-lg);
      padding: 24px;
      transition: all 0.15s ease;
    }

    .team-card:hover {
      border-color: var(--color-coral);
      box-shadow: var(--shadow-md);
    }

    .team-card-header {
      display: flex;
      align-items: center;
      gap: 16px;
      margin-bottom: 16px;
    }

    .team-card-avatar {
      width: 64px;
      height: 64px;
      border-radius: 50%;
      object-fit: cover;
      border: 3px solid var(--color-bg);
      flex-shrink: 0;
    }

    .team-card-info h4 { font-size: 16px; font-weight: 600; margin-bottom: 2px; color: var(--color-text); }
    .team-card-info .role { font-size: 13px; color: var(--color-coral); font-weight: 500; }
    .team-card-info .zone {
      display: inline-block;
      padding: 3px 10px;
      background: var(--color-bg);
      border-radius: 12px;
      font-size: 11px;
      color: var(--color-text-muted);
      margin-top: 6px;
      font-weight: 500;
    }

    .team-card-details {
      background: var(--color-bg);
      border-radius: var(--radius-md);
      padding: 14px 16px;
    }

    .team-detail-row {
      display: flex;
      align-items: center;
      gap: 10px;
      padding: 8px 0;
      border-bottom: 1px solid var(--color-border);
    }

    .team-detail-row:last-child { border-bottom: none; }

    .team-detail-row svg { width: 16px; height: 16px; color: var(--color-coral); flex-shrink: 0; }
    .team-detail-row .label { font-size: 12px; color: var(--color-text-muted); min-width: 70px; }
    .team-detail-row .value { font-size: 13px; color: var(--color-text); font-weight: 500; }
    .team-detail-row a { color: var(--color-coral); text-decoration: none; }
    .team-detail-row a:hover { text-decoration: underline; }

    /* Filter */
    .filter-bar {
      display: flex;
      align-items: center;
      gap: 12px;
      margin-bottom: 20px;
    }

    .filter-label { font-size: 14px; font-weight: 500; color: var(--color-text-muted); }

    .filter-select {
      padding: 10px 16px;
      border: 1px solid var(--color-border);
      border-radius: var(--radius-md);
      font-size: 14px;
      font-family: inherit;
      background: var(--color-white);
      cursor: pointer;
      min-width: 160px;
    }
    .filter-select:focus { outline: none; border-color: var(--color-coral); }

    /* Empty State */
    .empty-state {
      text-align: center;
      padding: 48px 24px;
      color: var(--color-text-muted);
    }
    .empty-state svg { width: 48px; height: 48px; margin-bottom: 16px; opacity: 0.4; }
    .empty-state h3 { font-size: 16px; font-weight: 600; margin-bottom: 6px; color: var(--color-text); }
    .empty-state p { font-size: 14px; }

    /* Modal */
    .modal-overlay {
      position: fixed;
      inset: 0;
      background: rgba(0, 0, 0, 0.5);
      display: flex;
      align-items: center;
      justify-content: center;
      z-index: 1000;
      opacity: 0;
      visibility: hidden;
      transition: all 0.2s ease;
    }

    .modal-overlay.active { opacity: 1; visibility: visible; }

    .modal {
      background: var(--color-white);
      border-radius: var(--radius-lg);
      max-width: 500px;
      width: 90%;
      max-height: 85vh;
      overflow-y: auto;
      transform: scale(0.95);
      transition: all 0.2s ease;
    }

    .modal-overlay.active .modal { transform: scale(1); }

    .modal-header {
      padding: 24px 24px 0;
      display: flex;
      justify-content: space-between;
      align-items: flex-start;
    }

    .modal-close {
      width: 32px;
      height: 32px;
      border: none;
      background: var(--color-bg);
      border-radius: 50%;
      cursor: pointer;
      display: flex;
      align-items: center;
      justify-content: center;
      color: var(--color-text-muted);
      transition: all 0.15s ease;
    }

    .modal-close:hover { background: var(--color-coral); color: white; }

    .modal-body { padding: 24px; }

    .modal-promo-title { font-size: 22px; font-weight: 700; margin-bottom: 8px; }
    .modal-promo-dates { font-size: 13px; color: var(--color-text-muted); margin-bottom: 16px; }
    .modal-promo-discount {
      display: inline-block;
      background: var(--gradient-primary);
      color: white;
      padding: 8px 18px;
      border-radius: 20px;
      font-size: 14px;
      font-weight: 600;
      margin-bottom: 20px;
    }

    .modal-promo-description { font-size: 14px; color: var(--color-text-muted); line-height: 1.7; margin-bottom: 20px; }

    .modal-promo-details { background: var(--color-bg); border-radius: var(--radius-md); padding: 16px; }
    .modal-promo-details h4 { font-size: 13px; font-weight: 600; margin-bottom: 10px; color: var(--color-text); }
    .modal-promo-details p { font-size: 13px; color: var(--color-text-muted); line-height: 1.6; }

    /* Mobile Responsive */
    @media (max-width: 1024px) {
      .stats-grid { grid-template-columns: repeat(2, 1fr); }
    }

    @media (max-width: 768px) {
      .mobile-header { display: flex; }
      .sidebar { transform: translateX(-100%); }
      .sidebar.open { transform: translateX(0); }
      .sidebar-overlay.open { display: block; }
      .main-content { margin-left: 0; padding: 72px 20px 32px; }
      .page-header h1 { font-size: 22px; }
      .hero-banner { padding: 24px; }
      .hero-banner h2 { font-size: 20px; }
      .stats-grid { grid-template-columns: 1fr 1fr; gap: 12px; }
      .practices-grid, .promo-grid, .discount-grid, .links-grid, .team-grid, .contact-grid, .responsibility-list { grid-template-columns: 1fr; }
      .tabs { flex-wrap: wrap; }
      .tab-btn { flex: 1; min-width: 100px; text-align: center; }
    }

    @media (max-width: 480px) {
      .stats-grid { grid-template-columns: 1fr; }
      .filter-bar { flex-direction: column; align-items: stretch; }
      .filter-select { width: 100%; }
    }
  </style>
</head>
<body>
  <div class="mobile-header">
    <button class="mobile-menu-btn" onclick="toggleSidebar()">
      <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
        <line x1="3" y1="12" x2="21" y2="12"></line>
        <line x1="3" y1="6" x2="21" y2="6"></line>
        <line x1="3" y1="18" x2="21" y2="18"></line>
      </svg>
    </button>
    <span style="font-size: 15px; font-weight: 700;">Director's Portal</span>
    <div style="width: 40px;"></div>
  </div>

  <div class="sidebar-overlay" id="sidebarOverlay" onclick="toggleSidebar()"></div>

  <div class="app-layout">
    <aside class="sidebar" id="sidebar">
      <div class="sidebar-header">
        <div class="sidebar-logo">
          <div class="sidebar-logo-icon">
            <svg width="22" height="22" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
              <path d="M4 19.5v-15A2.5 2.5 0 0 1 6.5 2H20v20H6.5a2.5 2.5 0 0 1 0-5H20"></path>
            </svg>
          </div>
          <div class="sidebar-logo-text">
            <h1>Director's Portal</h1>
            <p>Enrollment Resources</p>
          </div>
        </div>
      </div>

      <nav class="sidebar-nav">
        <div class="nav-section">
          <div class="nav-section-title">Overview</div>
          <a class="nav-item active" onclick="switchSection('dashboard', this)">
            <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
              <rect x="3" y="3" width="7" height="7" rx="1"></rect>
              <rect x="14" y="3" width="7" height="7" rx="1"></rect>
              <rect x="3" y="14" width="7" height="7" rx="1"></rect>
              <rect x="14" y="14" width="7" height="7" rx="1"></rect>
            </svg>
            Dashboard
          </a>
          <a class="nav-item" onclick="switchSection('promos', this)">
            <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
              <circle cx="12" cy="8" r="6"></circle>
              <path d="M15.477 12.89 17 22l-5-3-5 3 1.523-9.11"></path>
            </svg>
            Promotions
          </a>
          <a class="nav-item" onclick="switchSection('discounts', this)">
            <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
              <path d="M19 5 5 19"></path>
              <circle cx="6.5" cy="6.5" r="2.5"></circle>
              <circle cx="17.5" cy="17.5" r="2.5"></circle>
            </svg>
            Discounts
          </a>
        </div>

        <div class="nav-section">
          <div class="nav-section-title">Guide</div>
          <a class="nav-item" onclick="switchSection('working-with-us', this)">
            <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
              <path d="M17 21v-2a4 4 0 0 0-4-4H5a4 4 0 0 0-4 4v2"></path>
              <circle cx="9" cy="7" r="4"></circle>
              <path d="M23 21v-2a4 4 0 0 0-3-3.87"></path>
              <path d="M16 3.13a4 4 0 0 1 0 7.75"></path>
            </svg>
            Working With Us
          </a>
          <a class="nav-item" onclick="switchSection('best-practices', this)">
            <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
              <path d="M22 11.08V12a10 10 0 1 1-5.93-9.14"></path>
              <polyline points="22 4 12 14.01 9 11.01"></polyline>
            </svg>
            Best Practices
          </a>
          <a class="nav-item" onclick="switchSection('policies', this)">
            <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
              <path d="M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z"></path>
              <polyline points="14 2 14 8 20 8"></polyline>
              <line x1="16" y1="13" x2="8" y2="13"></line>
              <line x1="16" y1="17" x2="8" y2="17"></line>
            </svg>
            Policies
          </a>
          <a class="nav-item" onclick="switchSection('script', this)">
            <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
              <path d="M17 3a2.85 2.83 0 1 1 4 4L7.5 20.5 2 22l1.5-5.5Z"></path>
              <path d="m15 5 4 4"></path>
            </svg>
            Enrollment Script
          </a>
        </div>

        <div class="nav-section">
          <div class="nav-section-title">Support</div>
          <a class="nav-item" onclick="switchSection('resources', this)">
            <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
              <path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path>
              <path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path>
            </svg>
            Resources
          </a>
          <a class="nav-item" onclick="switchSection('team', this)">
            <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
              <path d="M22 16.92v3a2 2 0 0 1-2.18 2 19.79 19.79 0 0 1-8.63-3.07 19.5 19.5 0 0 1-6-6 19.79 19.79 0 0 1-3.07-8.67A2 2 0 0 1 4.11 2h3a2 2 0 0 1 2 1.72 12.84 12.84 0 0 0 .7 2.81 2 2 0 0 1-.45 2.11L8.09 9.91a16 16 0 0 0 6 6l1.27-1.27a2 2 0 0 1 2.11-.45 12.84 12.84 0 0 0 2.81.7A2 2 0 0 1 22 16.92z"></path>
            </svg>
            Contact Team
          </a>
        </div>
      </nav>

      <div class="sidebar-footer">
        <p>© 2026 Enrollment Team</p>
      </div>
    </aside>

    <main class="main-content">
      <!-- Dashboard -->
      <section id="dashboard" class="section active">
        <div class="page-header">
          <h1>Welcome to the Director's Portal</h1>
          <p>Stay informed with the latest updates and resources for enrollment success.</p>
        </div>

        <div class="hero-banner" id="promoBanner">
          <h2 id="promoTitle">Loading...</h2>
          <p id="promoDescription"></p>
          <span class="promo-badge" id="promoBadge" style="display: none;"></span>
        </div>

        <div class="stats-grid">
          <div class="stat-card">
            <div class="stat-card-label">Announcements</div>
            <div class="stat-card-value" id="statAnnouncements">-</div>
          </div>
          <div class="stat-card">
            <div class="stat-card-label">Active Promos</div>
            <div class="stat-card-value" id="statPromos">-</div>
          </div>
          <div class="stat-card">
            <div class="stat-card-label">Team Members</div>
            <div class="stat-card-value" id="statTeam">-</div>
          </div>
          <div class="stat-card">
            <div class="stat-card-label">Resources</div>
            <div class="stat-card-value" id="statLinks">-</div>
          </div>
        </div>

        <div class="card">
          <div class="card-header">
            <div class="card-icon">
              <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                <path d="m3 11 18-5v12L3 13v-2z"></path>
                <path d="M11.6 16.8a3 3 0 1 1-5.8-1.6"></path>
              </svg>
            </div>
            <div>
              <div class="card-title">Recent Announcements</div>
              <div class="card-subtitle">Latest updates from the enrollment team</div>
            </div>
          </div>
          <div class="announcement-list" id="announcementsList"></div>
        </div>
      </section>

      <!-- Promos -->
      <section id="promos" class="section">
        <div class="page-header">
          <h1>Promotions</h1>
          <p>View current, upcoming, and past promotional offers.</p>
        </div>

        <div class="tabs">
          <button class="tab-btn active" onclick="switchPromoTab('active', this)">Active</button>
          <button class="tab-btn" onclick="switchPromoTab('upcoming', this)">Upcoming</button>
          <button class="tab-btn" onclick="switchPromoTab('past', this)">Past</button>
        </div>

        <div class="promo-grid" id="promoGrid"></div>
      </section>

      <!-- Discounts -->
      <section id="discounts" class="section">
        <div class="page-header">
          <h1>Discounts</h1>
          <p>Available discount codes and special offers for families.</p>
        </div>

        <div class="tabs">
          <button class="tab-btn active" onclick="switchDiscountTab('active', this)">Active</button>
          <button class="tab-btn" onclick="switchDiscountTab('upcoming', this)">Upcoming</button>
          <button class="tab-btn" onclick="switchDiscountTab('expired', this)">Expired</button>
        </div>

        <div class="discount-grid" id="discountGrid"></div>
      </section>

      <!-- Working With Us -->
      <section id="working-with-us" class="section">
        <div class="page-header">
          <h1>Working With Us</h1>
          <p>How to communicate with the enrollment team and our division of responsibilities.</p>
        </div>

        <div class="card">
          <div class="card-header">
            <div class="card-icon">
              <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                <path d="M22 16.92v3a2 2 0 0 1-2.18 2 19.79 19.79 0 0 1-8.63-3.07 19.5 19.5 0 0 1-6-6 19.79 19.79 0 0 1-3.07-8.67A2 2 0 0 1 4.11 2h3a2 2 0 0 1 2 1.72 12.84 12.84 0 0 0 .7 2.81 2 2 0 0 1-.45 2.11L8.09 9.91a16 16 0 0 0 6 6l1.27-1.27a2 2 0 0 1 2.11-.45 12.84 12.84 0 0 0 2.81.7A2 2 0 0 1 22 16.92z"></path>
              </svg>
            </div>
            <div>
              <div class="card-title">How to Reach Us</div>
              <div class="card-subtitle">Choose the best communication method for your needs</div>
            </div>
          </div>
          <div class="contact-grid">
            <div class="contact-card">
              <div class="contact-card-icon">
                <svg width="22" height="22" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                  <rect width="20" height="16" x="2" y="4" rx="2"></rect>
                  <path d="m22 7-8.97 5.7a1.94 1.94 0 0 1-2.06 0L2 7"></path>
                </svg>
              </div>
              <div class="contact-card-content">
                <h4>Email (Non-Urgent)</h4>
                <p>General questions, policy clarifications, and resource requests.</p>
                <a href="mailto:enrollment@example.com">enrollment@example.com</a>
              </div>
            </div>
            <div class="contact-card">
              <div class="contact-card-icon">
                <svg width="22" height="22" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                  <path d="M22 16.92v3a2 2 0 0 1-2.18 2 19.79 19.79 0 0 1-8.63-3.07 19.5 19.5 0 0 1-6-6 19.79 19.79 0 0 1-3.07-8.67A2 2 0 0 1 4.11 2h3a2 2 0 0 1 2 1.72 12.84 12.84 0 0 0 .7 2.81 2 2 0 0 1-.45 2.11L8.09 9.91a16 16 0 0 0 6 6l1.27-1.27a2 2 0 0 1 2.11-.45 12.84 12.84 0 0 0 2.81.7A2 2 0 0 1 22 16.92z"></path>
                </svg>
              </div>
              <div class="contact-card-content">
                <h4>Phone (Urgent)</h4>
                <p>Time-sensitive issues requiring immediate assistance.</p>
                <a href="tel:555-123-4567">(555) 123-4567</a>
              </div>
            </div>
            <div class="contact-card">
              <div class="contact-card-icon">
                <svg width="22" height="22" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                  <rect width="18" height="18" x="3" y="4" rx="2" ry="2"></rect>
                  <line x1="16" x2="16" y1="2" y2="6"></line>
                  <line x1="8" x2="8" y1="2" y2="6"></line>
                  <line x1="3" x2="21" y1="10" y2="10"></line>
                </svg>
              </div>
              <div class="contact-card-content">
                <h4>Schedule a Meeting</h4>
                <p>Book time for strategy, training, or complex cases.</p>
                <a href="#" onclick="switchSection('resources', this); return false;">View available times →</a>
              </div>
            </div>
          </div>
        </div>

        <div class="card">
          <div class="card-header">
            <div class="card-icon">
              <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                <path d="M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2"></path>
                <circle cx="9" cy="7" r="4"></circle>
                <line x1="19" x2="19" y1="8" y2="14"></line>
                <line x1="22" x2="16" y1="11" y2="11"></line>
              </svg>
            </div>
            <div>
              <div class="card-title">Division of Responsibilities</div>
              <div class="card-subtitle">Clear boundaries for effective collaboration</div>
            </div>
          </div>

          <div class="responsibility-section">
            <div class="responsibility-header">
              <span class="responsibility-badge we-handle">
                <svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="3"><polyline points="20 6 9 17 4 12"></polyline></svg>
                What We Handle
              </span>
            </div>
            <div class="responsibility-list">
              <div class="responsibility-item we-handle">
                <div class="icon-wrapper"><svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2.5"><polyline points="20 6 9 17 4 12"></polyline></svg></div>
                <span>All inbound enrollment inquiries and follow-ups</span>
              </div>
              <div class="responsibility-item we-handle">
                <div class="icon-wrapper"><svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2.5"><polyline points="20 6 9 17 4 12"></polyline></svg></div>
                <span>Scheduling tours and enrollment appointments</span>
              </div>
              <div class="responsibility-item we-handle">
                <div class="icon-wrapper"><svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2.5"><polyline points="20 6 9 17 4 12"></polyline></svg></div>
                <span>Processing applications and paperwork</span>
              </div>
              <div class="responsibility-item we-handle">
                <div class="icon-wrapper"><svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2.5"><polyline points="20 6 9 17 4 12"></polyline></svg></div>
                <span>Payment setup and financial questions</span>
              </div>
              <div class="responsibility-item we-handle">
                <div class="icon-wrapper"><svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2.5"><polyline points="20 6 9 17 4 12"></polyline></svg></div>
                <span>Nurturing leads until enrollment is complete</span>
              </div>
              <div class="responsibility-item we-handle">
                <div class="icon-wrapper"><svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2.5"><polyline points="20 6 9 17 4 12"></polyline></svg></div>
                <span>Reporting and enrollment analytics</span>
              </div>
            </div>
          </div>

          <div class="responsibility-section">
            <div class="responsibility-header">
              <span class="responsibility-badge you-handle">
                <svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2.5"><polyline points="9 18 15 12 9 6"></polyline></svg>
                What Directors Handle
              </span>
            </div>
            <div class="responsibility-list">
              <div class="responsibility-item you-handle">
                <div class="icon-wrapper"><svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2.5"><polyline points="9 18 15 12 9 6"></polyline></svg></div>
                <span>Conducting tours and building relationships</span>
              </div>
              <div class="responsibility-item you-handle">
                <div class="icon-wrapper"><svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2.5"><polyline points="9 18 15 12 9 6"></polyline></svg></div>
                <span>Answering curriculum and program questions</span>
              </div>
              <div class="responsibility-item you-handle">
                <div class="icon-wrapper"><svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2.5"><polyline points="9 18 15 12 9 6"></polyline></svg></div>
                <span>Providing classroom availability updates</span>
              </div>
              <div class="responsibility-item you-handle">
                <div class="icon-wrapper"><svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2.5"><polyline points="9 18 15 12 9 6"></polyline></svg></div>
                <span>Notifying us of local events or partnerships</span>
              </div>
              <div class="responsibility-item you-handle">
                <div class="icon-wrapper"><svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2.5"><polyline points="9 18 15 12 9 6"></polyline></svg></div>
                <span>Following up with enrolled families post-start</span>
              </div>
              <div class="responsibility-item you-handle">
                <div class="icon-wrapper"><svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2.5"><polyline points="9 18 15 12 9 6"></polyline></svg></div>
                <span>Maintaining Google/Yelp reviews and ratings</span>
              </div>
            </div>
          </div>
        </div>
      </section>

      <!-- Best Practices -->
      <section id="best-practices" class="section">
        <div class="page-header">
          <h1>Best Practices</h1>
          <p>Follow these guidelines to maximize enrollment success at your location.</p>
        </div>

        <div class="practices-grid">
          <div class="practice-card">
            <h4><span class="number">1</span> Respond Within 5 Minutes</h4>
            <p>When a lead is handed off or a tour is scheduled, acknowledge within 5 minutes during business hours. Speed to lead is the #1 factor in conversion.</p>
          </div>
          <div class="practice-card">
            <h4><span class="number">2</span> Keep Availability Updated</h4>
            <p>Update your classroom availability weekly. Nothing kills momentum like telling a family we have space when we don't.</p>
            <ul><li>Update every Monday by 10am</li><li>Notify us immediately if a spot opens</li><li>Include waitlist numbers</li></ul>
          </div>
          <div class="practice-card">
            <h4><span class="number">3</span> Prepare for Every Tour</h4>
            <p>A prepared tour converts 3x better than an improvised one.</p>
            <ul><li>Review family info before arrival</li><li>Have enrollment packet ready</li><li>Ensure classrooms are tour-ready</li><li>Introduce to key teachers</li></ul>
          </div>
          <div class="practice-card">
            <h4><span class="number">4</span> Follow the Enrollment Script</h4>
            <p>Our script is tested and proven. Use it as your guide during tours and calls. Customize your stories, but keep the structure.</p>
          </div>
          <div class="practice-card">
            <h4><span class="number">5</span> Ask for the Enrollment</h4>
            <p>Don't end a tour without asking: "Based on what you've seen, are you ready to secure your spot?" Assumptive closes work.</p>
          </div>
          <div class="practice-card">
            <h4><span class="number">6</span> Request Reviews</h4>
            <p>After a successful first week, ask families to leave a Google review. Aim for 50+ reviews with 4.5+ stars.</p>
            <ul><li>Send review link via text</li><li>Ask in person at pickup</li><li>Follow up if they forget</li></ul>
          </div>
        </div>
      </section>

      <!-- Policies -->
      <section id="policies" class="section">
        <div class="page-header">
          <h1>Policies & Guidelines</h1>
          <p>Official policies that govern our enrollment process.</p>
        </div>
        <div class="card">
          <div id="policiesContainer"></div>
        </div>
      </section>

      <!-- Script -->
      <section id="script" class="section">
        <div class="page-header">
          <h1>Enrollment Script</h1>
          <p>Use this proven script as your guide during tours and enrollment conversations.</p>
        </div>
        <div class="script-container">
          <div class="script-content" id="scriptContent"><p style="color: var(--color-text-muted);">Loading script...</p></div>
        </div>
      </section>

      <!-- Resources -->
      <section id="resources" class="section">
        <div class="page-header">
          <h1>Resources & Links</h1>
          <p>Quick access to tools, documents, and helpful resources.</p>
        </div>
        <div class="card">
          <div class="card-header" style="flex-wrap:wrap;gap:12px">
            <div style="display:flex;align-items:center;gap:12px">
              <div class="card-icon">
                <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                  <path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path>
                  <path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path>
                </svg>
              </div>
              <div>
                <div class="card-title">Quick Links</div>
                <div class="card-subtitle">Frequently used resources and tools</div>
              </div>
            </div>
            <div style="flex:1;max-width:300px">
              <input type="text" class="form-input" id="linkSearch" placeholder="Search resources..." oninput="filterLinks()" style="margin:0;padding:10px 14px;border-radius:var(--radius-sm)">
            </div>
          </div>
          <div id="linksContainer"></div>
        </div>
      </section>

      <!-- Team -->
      <section id="team" class="section">
        <div class="page-header">
          <h1>Contact the Team</h1>
          <p>Reach out to your enrollment specialist for personalized support.</p>
        </div>
        <div class="filter-bar">
          <span class="filter-label">Filter by zone:</span>
          <select class="filter-select" id="zoneFilter" onchange="filterTeamByZone()">
            <option value="all">All Zones</option>
          </select>
        </div>
        <div class="team-grid" id="teamGrid"></div>
      </section>
    </main>
  </div>

  <!-- Promo Detail Modal -->
  <div class="modal-overlay" id="promoModal" onclick="closePromoModal(event)">
    <div class="modal" onclick="event.stopPropagation()">
      <div class="modal-header">
        <div id="modalPromoStatus"></div>
        <button class="modal-close" onclick="closePromoModal()">
          <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
            <line x1="18" y1="6" x2="6" y2="18"></line>
            <line x1="6" y1="6" x2="18" y2="18"></line>
          </svg>
        </button>
      </div>
      <div class="modal-body">
        <h3 class="modal-promo-title" id="modalPromoTitle"></h3>
        <p class="modal-promo-dates" id="modalPromoDates"></p>
        <div class="modal-promo-discount" id="modalPromoDiscount"></div>
        <p class="modal-promo-description" id="modalPromoDescription"></p>
        <div class="modal-promo-details" id="modalPromoDetails" style="display: none;">
          <h4>Additional Details</h4>
          <p id="modalPromoDetailsText"></p>
        </div>
      </div>
    </div>
  </div>

  <script>
    const SUPABASE_URL = 'https://kvyvjwepfrqqkvyyutdw.supabase.co';
    const SUPABASE_ANON_KEY = 'eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6Imt2eXZqd2VwZnJxcWt2eXl1dGR3Iiwicm9sZSI6ImFub24iLCJpYXQiOjE3NjcyMjgyOTgsImV4cCI6MjA4MjgwNDI5OH0.ZayLxzQCEFENvQ9FwpLm4x2le2Y9kJvSslX8DVRzAh8';

    let supabaseClient = null;
    let announcements = [], promos = [], discounts = [], policies = [], links = [], linkCategories = [], team = [], zones = [], scriptContent = '';
    let currentPromoTab = 'active';
    let currentDiscountTab = 'active';

    async function init() {
      console.log('Director init starting...');
      try {
        supabaseClient = window.supabase.createClient(SUPABASE_URL, SUPABASE_ANON_KEY);
        console.log('Supabase client created');
        const { error } = await supabaseClient.from('announcements').select('count');
        console.log('Test query result:', error ? 'error' : 'success');
        if (!error) { await loadAllData(); return; }
      } catch (e) { console.error('Init error:', e); }
      loadFromLocalStorage();
    }

    async function loadAllData() {
      console.log('loadAllData starting...');
      try {
        const [p1, p2, p3, p4, p5, p6, p7, p8, p9] = await Promise.all([
          supabaseClient.from('promos').select('*').order('start_date', { ascending: false }),
          supabaseClient.from('announcements').select('*').eq('active', true).order('created_at', { ascending: false }),
          supabaseClient.from('policies').select('*').order('category'),
          supabaseClient.from('links').select('*').order('sort_order'),
          supabaseClient.from('team_members').select('*').order('sort_order'),
          supabaseClient.from('zones').select('*').order('sort_order'),
          supabaseClient.from('settings').select('value').eq('key', 'enrollment_script').single(),
          supabaseClient.from('discounts').select('*').order('start_date', { ascending: false }),
          supabaseClient.from('link_categories').select('*').order('sort_order')
        ]);
        console.log('Data loaded:', {promos: p1.data?.length, announcements: p2.data?.length, policies: p3.data?.length, links: p4.data?.length, team: p5.data?.length});
        promos = p1.data || []; announcements = p2.data || []; policies = p3.data || [];
        links = p4.data || []; team = p5.data || []; zones = p6.data || [];
        scriptContent = p7.data?.value || getDefaultScript();
        discounts = p8.data || [];
        linkCategories = p9.data || [];
        console.log('Calling renderAll...');
        renderAll();
      } catch (e) { console.error('loadAllData error:', e); loadFromLocalStorage(); }
    }

    function loadFromLocalStorage() {
      promos = JSON.parse(localStorage.getItem('admin_promos') || '[]');
      announcements = JSON.parse(localStorage.getItem('admin_announcements') || '[]');
      policies = JSON.parse(localStorage.getItem('admin_policies') || '[]');
      links = JSON.parse(localStorage.getItem('admin_links') || '[]');
      team = JSON.parse(localStorage.getItem('admin_team') || '[]');
      zones = JSON.parse(localStorage.getItem('admin_zones') || '[]');
      discounts = JSON.parse(localStorage.getItem('admin_discounts') || '[]');
      linkCategories = JSON.parse(localStorage.getItem('admin_link_categories') || '[]');
      scriptContent = localStorage.getItem('admin_script') || getDefaultScript();
      renderAll();
    }

    function getDefaultScript() {
      return `<h2>Welcome Script</h2><p>Hello! My name is [Your Name], and I'm excited to show you around today.</p>
        <h3>Opening Questions</h3><ul><li>What brings you to us today?</li><li>Tell me about your child</li><li>What's most important to you in a program?</li></ul>
        <h3>Tour Flow</h3><ol><li>The classroom your child would be in</li><li>Outdoor play areas</li><li>Safety and security features</li><li>Where meals are prepared</li></ol>
        <blockquote>"What makes us different is our focus on [unique value]. Parents tell us they chose us because..."</blockquote>
        <h3>Closing</h3><p>Based on everything we've discussed, I think your child would really thrive here. We do have limited availability in that classroom—would you like to secure your spot today?</p>`;
    }

    function renderAll() {
      renderHeroBanner(); renderStats(); renderAnnouncements(); renderPromos(); renderDiscounts();
      renderPolicies(); renderScript(); renderLinks(); renderTeam(); renderZoneFilter();
    }

    function getPromoStatus(promo) {
      const now = new Date();
      const start = new Date(promo.start_date);
      const end = promo.end_date ? new Date(promo.end_date) : null;
      if (start > now) return 'upcoming';
      if (end && end < now) return 'ended';
      return 'active';
    }

    function renderHeroBanner() {
      const active = promos.find(p => getPromoStatus(p) === 'active');
      document.getElementById('promoTitle').textContent = active ? active.title : "Welcome to the Director's Portal";
      document.getElementById('promoDescription').textContent = active?.description || 'Your central hub for enrollment resources, policies, and team communication.';
      const badge = document.getElementById('promoBadge');
      if (active) { badge.textContent = active.discount || 'Limited Time Offer'; badge.style.display = 'inline-flex'; }
      else { badge.style.display = 'none'; }
    }

    function renderStats() {
      const activePromos = promos.filter(p => getPromoStatus(p) === 'active').length;
      document.getElementById('statAnnouncements').textContent = announcements.length;
      document.getElementById('statPromos').textContent = activePromos;
      document.getElementById('statTeam').textContent = team.length;
      document.getElementById('statLinks').textContent = links.length;
    }

    function renderAnnouncements() {
      const c = document.getElementById('announcementsList');
      if (!announcements.length) { c.innerHTML = '<div class="empty-state"><p>No announcements yet</p></div>'; return; }
      c.innerHTML = announcements.slice(0, 5).map(a => {
        const d = new Date(a.date || a.created_at);
        return `<div class="announcement-item"><div class="announcement-date"><div class="day">${d.getDate()}</div><div class="month">${d.toLocaleString('en',{month:'short'})}</div></div><div class="announcement-content"><h4>${esc(a.title)}</h4><p>${esc(a.content||'')}</p></div></div>`;
      }).join('');
    }

    function switchPromoTab(tab, btn) {
      currentPromoTab = tab;
      document.querySelectorAll('#promos .tab-btn').forEach(b => b.classList.remove('active'));
      if (btn) btn.classList.add('active');
      renderPromos();
    }

    function renderPromos() {
      const c = document.getElementById('promoGrid');
      const filtered = promos.filter(p => getPromoStatus(p) === currentPromoTab);
      
      if (!filtered.length) {
        const msgs = { active: 'No active promotions', upcoming: 'No upcoming promotions', past: 'No past promotions' };
        c.innerHTML = `<div class="empty-state" style="grid-column: 1/-1;"><p>${msgs[currentPromoTab]}</p></div>`;
        return;
      }

      c.innerHTML = filtered.map(p => {
        const status = getPromoStatus(p);
        const startDate = new Date(p.start_date).toLocaleDateString('en-US', { month: 'short', day: 'numeric', year: 'numeric' });
        const endDate = p.end_date ? new Date(p.end_date).toLocaleDateString('en-US', { month: 'short', day: 'numeric', year: 'numeric' }) : 'Ongoing';
        return `
          <div class="promo-card">
            <div class="promo-card-header">
              <span class="promo-status ${status}">${status}</span>
            </div>
            <h4>${esc(p.title)}</h4>
            <div class="promo-dates">${startDate} - ${endDate}</div>
            ${p.discount ? `<div class="promo-discount">${esc(p.discount)}</div>` : ''}
            <p>${esc(p.description || 'No description available.')}</p>
            <button class="promo-details-btn" onclick='openPromoModal(${JSON.stringify(p).replace(/'/g, "&#39;")})'>
              <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                <circle cx="12" cy="12" r="10"></circle>
                <path d="M12 16v-4"></path>
                <path d="M12 8h.01"></path>
              </svg>
              View Details
            </button>
          </div>
        `;
      }).join('');
    }

    function openPromoModal(promo) {
      const status = getPromoStatus(promo);
      const startDate = new Date(promo.start_date).toLocaleDateString('en-US', { weekday: 'long', month: 'long', day: 'numeric', year: 'numeric' });
      const endDate = promo.end_date ? new Date(promo.end_date).toLocaleDateString('en-US', { weekday: 'long', month: 'long', day: 'numeric', year: 'numeric' }) : 'No end date (ongoing)';

      document.getElementById('modalPromoStatus').innerHTML = `<span class="promo-status ${status}">${status}</span>`;
      document.getElementById('modalPromoTitle').textContent = promo.title;
      document.getElementById('modalPromoDates').textContent = `${startDate} — ${endDate}`;
      document.getElementById('modalPromoDiscount').textContent = promo.discount || 'Special Offer';
      document.getElementById('modalPromoDescription').textContent = promo.description || 'No description provided.';
      
      const detailsEl = document.getElementById('modalPromoDetails');
      const detailsText = document.getElementById('modalPromoDetailsText');
      if (promo.details) {
        detailsText.textContent = promo.details;
        detailsEl.style.display = 'block';
      } else {
        detailsEl.style.display = 'none';
      }

      document.getElementById('promoModal').classList.add('active');
    }

    function closePromoModal(e) {
      if (e && e.target !== e.currentTarget) return;
      document.getElementById('promoModal').classList.remove('active');
    }

    function getDiscountStatus(d) {
      const now = new Date();
      const start = new Date(d.start_date);
      const end = d.end_date ? new Date(d.end_date) : null;
      if (start > now) return 'upcoming';
      if (end && end < now) return 'expired';
      return 'active';
    }

    function switchDiscountTab(tab, btn) {
      currentDiscountTab = tab;
      document.querySelectorAll('#discounts .tab-btn').forEach(b => b.classList.remove('active'));
      if (btn) btn.classList.add('active');
      renderDiscounts();
    }

    function renderDiscounts() {
      const c = document.getElementById('discountGrid');
      const filtered = discounts.filter(d => getDiscountStatus(d) === currentDiscountTab);
      
      if (!filtered.length) {
        const msgs = { active: 'No active discounts', upcoming: 'No upcoming discounts', expired: 'No expired discounts' };
        c.innerHTML = `<div class="empty-state" style="grid-column: 1/-1;"><p>${msgs[currentDiscountTab]}</p></div>`;
        return;
      }

      c.innerHTML = filtered.map(d => {
        const status = getDiscountStatus(d);
        const startDate = new Date(d.start_date).toLocaleDateString('en-US', { month: 'short', day: 'numeric', year: 'numeric' });
        const endDate = d.end_date ? new Date(d.end_date).toLocaleDateString('en-US', { month: 'short', day: 'numeric', year: 'numeric' }) : 'No Expiry';
        return `
          <div class="discount-card">
            <div class="discount-card-header">
              <span class="discount-status ${status}">${status}</span>
            </div>
            <h4>${esc(d.title)}</h4>
            <div class="discount-dates">${startDate} - ${endDate}</div>
            <div class="discount-amount">${esc(d.amount)}</div>
            <p>${esc(d.description || '')}</p>
          </div>
        `;
      }).join('');
    }

    function renderPolicies() {
      const c = document.getElementById('policiesContainer');
      if (!policies.length) { c.innerHTML = '<div class="empty-state"><p>No policies added yet</p></div>'; return; }
      const g = policies.reduce((a,p) => { const cat = p.category||'General'; if(!a[cat])a[cat]=[]; a[cat].push(p); return a; }, {});
      c.innerHTML = Object.entries(g).map(([cat, items]) => `
        <div class="policy-category"><div class="policy-category-title"><svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M22 19a2 2 0 0 1-2 2H4a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h5l2 3h9a2 2 0 0 1 2 2z"></path></svg>${esc(cat)}</div>
        <div class="policy-list">${items.map(p => `<a href="${esc(p.url||'#')}" target="_blank" class="policy-item" style="flex-direction:column;align-items:stretch"><div style="display:flex;align-items:center;justify-content:space-between;width:100%"><div class="policy-item-info"><div class="policy-item-icon"><svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z"></path><polyline points="14 2 14 8 20 8"></polyline></svg></div><h4>${esc(p.title)}</h4></div><svg class="arrow" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><polyline points="9 18 15 12 9 6"></polyline></svg></div>${p.description?`<div style="font-size:13px;color:var(--color-text-muted);margin-top:8px;line-height:1.5">${p.description}</div>`:''}</a>`).join('')}</div></div>
      `).join('');
    }

    function renderScript() {
      document.getElementById('scriptContent').innerHTML = scriptContent;
    }

    function renderLinks() {
      const c = document.getElementById('linksContainer');
      const search = (document.getElementById('linkSearch')?.value || '').toLowerCase();
      let filteredLinks = links;
      if (search) filteredLinks = links.filter(l => (l.title || '').toLowerCase().includes(search) || (l.category || '').toLowerCase().includes(search));
      
      if (!filteredLinks.length && !linkCategories.length) { 
        c.innerHTML = '<div class="empty-state"><p>No links added yet</p></div>'; 
        return; 
      }
      
      const grouped = {};
      linkCategories.forEach(cat => { grouped[cat.name] = []; });
      grouped['Uncategorized'] = [];
      filteredLinks.forEach(l => {
        const cat = l.category || 'Uncategorized';
        if (!grouped[cat]) grouped[cat] = [];
        grouped[cat].push(l);
      });
      
      c.innerHTML = Object.entries(grouped).filter(([cat, items]) => items.length > 0).map(([cat, items]) => `
        <div class="link-category" style="margin-bottom:24px">
          <div style="font-weight:600;font-size:14px;color:var(--color-text-muted);margin-bottom:12px;display:flex;align-items:center;gap:8px">
            <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M22 19a2 2 0 0 1-2 2H4a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h5l2 3h9a2 2 0 0 1 2 2z"/></svg>
            ${esc(cat)} (${items.length})
          </div>
          <div class="links-grid">${items.map(l => `<a href="${esc(l.url)}" target="_blank" class="link-card"><div class="link-card-icon"><svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path></svg></div><div><h4>${esc(l.title)}</h4></div></a>`).join('')}</div>
        </div>
      `).join('');
      
      if (!c.innerHTML) c.innerHTML = '<div class="empty-state"><p>No matching resources found</p></div>';
    }
    
    function filterLinks() { renderLinks(); }

    function renderTeam() {
      const c = document.getElementById('teamGrid');
      const f = document.getElementById('zoneFilter').value;
      let filtered = f === 'all' ? team : team.filter(t => t.zone === f);
      
      if (!filtered.length) { 
        c.innerHTML = '<div class="empty-state" style="grid-column:1/-1"><p>No team members found</p></div>'; 
        return; 
      }
      
      c.innerHTML = filtered.map(t => {
        const fullName = t.name || ((t.first_name || '') + ' ' + (t.last_name || '')).trim() || 'Team Member';
        return `
        <div class="team-card">
          <div class="team-card-header">
            <img src="${esc(t.avatar_url||'https://images.unsplash.com/photo-1472099645785-5658abf4ff4e?w=150&h=150&fit=crop&crop=face')}" class="team-card-avatar" alt="${esc(fullName)}">
            <div class="team-card-info">
              <h4>${esc(fullName)}</h4>
              <div class="role">${esc(t.role||'Enrollment Specialist')}</div>
              <div class="zone">${esc(t.zone||'General')}</div>
            </div>
          </div>
          <div class="team-card-details">
            <div class="team-detail-row">
              <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><rect width="20" height="16" x="2" y="4" rx="2"></rect><path d="m22 7-8.97 5.7a1.94 1.94 0 0 1-2.06 0L2 7"></path></svg>
              <span class="label">Email</span>
              <a href="mailto:${esc(t.email)}" class="value">${esc(t.email||'Not provided')}</a>
            </div>
            <div class="team-detail-row">
              <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M22 16.92v3a2 2 0 0 1-2.18 2 19.79 19.79 0 0 1-8.63-3.07 19.5 19.5 0 0 1-6-6 19.79 19.79 0 0 1-3.07-8.67A2 2 0 0 1 4.11 2h3a2 2 0 0 1 2 1.72 12.84 12.84 0 0 0 .7 2.81 2 2 0 0 1-.45 2.11L8.09 9.91a16 16 0 0 0 6 6l1.27-1.27a2 2 0 0 1 2.11-.45 12.84 12.84 0 0 0 2.81.7A2 2 0 0 1 22 16.92z"></path></svg>
              <span class="label">Ext.</span>
              <span class="value">${esc(t.extension||'N/A')}</span>
            </div>
            <div class="team-detail-row">
              <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2"></path><circle cx="9" cy="7" r="4"></circle></svg>
              <span class="label">Role</span>
              <span class="value">${esc(t.role||'Enrollment Specialist')}</span>
            </div>
          </div>
        </div>
      `}).join('');
    }

    function renderZoneFilter() {
      const s = document.getElementById('zoneFilter');
      const zs = zones.length ? zones.map(z=>z.name) : [...new Set(team.map(t=>t.zone).filter(Boolean))];
      s.innerHTML = '<option value="all">All Zones</option>' + zs.map(z=>`<option value="${esc(z)}">${esc(z)}</option>`).join('');
    }

    function filterTeamByZone() { renderTeam(); }

    function switchSection(id, el) {
      document.querySelectorAll('.nav-item').forEach(i => i.classList.remove('active'));
      if (el) el.classList.add('active');
      document.querySelectorAll('.section').forEach(s => s.classList.remove('active'));
      document.getElementById(id).classList.add('active');
      closeSidebar();
      window.scrollTo(0, 0);
    }

    function toggleSidebar() {
      document.getElementById('sidebar').classList.toggle('open');
      document.getElementById('sidebarOverlay').classList.toggle('open');
    }

    function closeSidebar() {
      document.getElementById('sidebar').classList.remove('open');
      document.getElementById('sidebarOverlay').classList.remove('open');
    }

    function esc(t) {
      if (!t) return '';
      const d = document.createElement('div');
      d.textContent = t;
      return d.innerHTML;
    }

    document.addEventListener('DOMContentLoaded', init);
  </script>
</body>
</html>
